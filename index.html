<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<title>–¢–µ—Å—Ç –Ω–∞ –ø–∞–º'—è—Ç—å</title>
<style>
  body {
    font-family: sans-serif;
    text-align: center;
    padding-top: 60px;
    background: linear-gradient(to bottom right, #c9e9ff, #f8f9fa);
  }
  #digits {
    font-size: 3em;
    margin: 40px;
    min-height: 1.2em;
    transition: opacity 0.2s ease-in-out;
  }
  input, button {
    font-size: 1.2em;
    padding: 10px 20px;
    margin: 10px;
    border-radius: 10px;
    border: 2px solid #ccc;
  }
  button {
    cursor: pointer;
    background: #007bff;
    color: white;
    border: none;
  }
  button:hover { background: #0056b3; }
  #result {
    font-weight: bold;
    margin-top: 20px;
    font-size: 1.3em;
  }
  #final {
    font-size: 1.5em;
    margin-top: 30px;
  }
</style>
</head>
<body>

<h2>üß† –¢–µ—Å—Ç –Ω–∞ –ø–∞–º'—è—Ç—å</h2>

<!-- –ü–æ—á–∞—Ç–∫–æ–≤–∏–π –µ–∫—Ä–∞–Ω -->
<div id="startScreen">
  <p>–í–≤–µ–¥–∏ —Å–≤–æ—î —ñ–º‚Äô—è, —â–æ–± –ø–æ—á–∞—Ç–∏:</p>
  <input type="text" id="username" placeholder="–¢–≤–æ—î —ñ–º‚Äô—è">
  <br>
  <button id="startBtn">–ü–æ—á–∞—Ç–∏</button>
</div>

<!-- –ï–∫—Ä–∞–Ω –≥—Ä–∏ -->
<div id="gameScreen" style="display:none;">
  <p id="level"></p>
  <p id="digits"></p>

  <input id="answer" type="text" placeholder="–í–≤–µ–¥–∏ —Ü–∏—Ñ—Ä–∏ —É –∑–≤–æ—Ä–æ—Ç–Ω–æ–º—É –ø–æ—Ä—è–¥–∫—É" disabled>
  <br>
  <button id="checkBtn" disabled>–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏</button>
  <p id="result"></p>
  <p id="final"></p>
</div>

<!-- –°–∫—Ä–∏–ø—Ç -->
<script>
document.addEventListener("DOMContentLoaded", () => {
  let currentLevel = 3;
  let round = 1;
  let digits = "";
  let correctAnswers = 0;
  let playerName = "";

  const digitsEl = document.getElementById("digits");
  const inputEl = document.getElementById("answer");
  const resultEl = document.getElementById("result");
  const buttonEl = document.getElementById("checkBtn");
  const levelEl = document.getElementById("level");
  const finalEl = document.getElementById("final");
  const startScreen = document.getElementById("startScreen");
  const gameScreen = document.getElementById("gameScreen");
  const startBtn = document.getElementById("startBtn");

  startBtn.addEventListener("click", startGame);
  buttonEl.addEventListener("click", check);

  function startGame() {
    const name = document.getElementById("username").value.trim();
    if (!name) {
      alert("–í–≤–µ–¥–∏ —ñ–º‚Äô—è, –±—É–¥—å –ª–∞—Å–∫–∞ üôÇ");
      return;
    }
    playerName = name;
    startScreen.style.display = "none";
    gameScreen.style.display = "block";
    showDigits();
  }

  function showDigits() {
    resultEl.innerText = "";
    inputEl.value = "";
    inputEl.disabled = true;
    buttonEl.disabled = true;
    digitsEl.innerText = "";
    finalEl.innerText = "";

    levelEl.innerText = `–†—ñ–≤–µ–Ω—å ${currentLevel - 2} (—Å–ø—Ä–æ–±–∞ ${round}/3)`;

    digits = "";
    for (let i = 0; i < currentLevel; i++) digits += Math.floor(Math.random() * 10);

    let i = 0;
    function showNext() {
      if (i < digits.length) {
        digitsEl.innerText = digits[i];
        digitsEl.style.opacity = 1;

        setTimeout(() => {
          digitsEl.style.opacity = 0;
          setTimeout(() => {
            i++;
            showNext();
          }, 300);
        }, 800);
      } else {
        setTimeout(() => {
          digitsEl.innerText = "‚ùì";
          digitsEl.style.opacity = 1;
          inputEl.disabled = false;
          buttonEl.disabled = false;
          inputEl.focus();
        }, 300);
      }
    }

    showNext();
  }

  function check() {
    const input = inputEl.value.trim();
    const correct = digits.split("").reverse().join("");

    if (input === correct) {
      resultEl.innerText = "‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ!";
      resultEl.style.color = "green";
      correctAnswers++;
    } else {
      resultEl.innerText = `‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ (–±—É–ª–æ: ${correct})`;
      resultEl.style.color = "red";
    }

    setTimeout(nextRound, 1500);
  }

  function nextRound() {
    round++;
    if (round > 3) {
      round = 1;
      currentLevel++;
    }

    if (currentLevel > 7) {
      finishGame();
    } else {
      showDigits();
    }
  }

  function finishGame() {
    digitsEl.innerText = "";
    inputEl.disabled = true;
    buttonEl.disabled = true;
    levelEl.innerText = "";
    resultEl.innerText = "";

    finalEl.innerHTML = `
      üéâ <b>–ì—Ä—É –∑–∞–≤–µ—Ä—à–µ–Ω–æ!</b><br>
      ${playerName}, —Ç–≤—ñ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: <b>${correctAnswers} –ø—Ä–∞–≤–∏–ª—å–Ω–∏—Ö —ñ–∑ 15.</b>
    `;

    // –ù–∞–¥—Å–∏–ª–∞–Ω–Ω—è —É Google –¢–∞–±–ª–∏—Ü—é
    fetch("https://script.google.com/macros/s/AKfycbxjlryvmhZq3VreJu3xTMbLgGUhWJq6gZQQtMtFQ2fvBFFk9eMTCGNppII3zO30SM7CZA/exec", {
      method: "POST",
      mode: "no-cors",
      body: JSON.stringify({ name: playerName, score: correctAnswers }),
      headers: { "Content-Type": "application/json" }
    });
  }
});
</script>

</body>
</html>
